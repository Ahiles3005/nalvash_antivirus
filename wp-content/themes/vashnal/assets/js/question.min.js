jQuery(function(a){let questionForm={buttonOpenForm:a("#open_question_form"),md5Script:question_params.add_script,formSelector:".question-form",secretSelector:'input[name="secret"]',secretSourceSelector:'input[name="secret_source"]',allFormElementsSelector:".question-form :input",init:function(){this.buttonOpenForm.on("click",this.open)},open:function(){a.ajax({url:question_params.url,type:"POST",data:{action:question_params.action},success:function(b){popup.open(b);questionForm.setup()}})},setup:function(){a.getScript(questionForm.md5Script,function(){if(typeof md5==="function"){a(questionForm.secretSelector).val(md5(a(questionForm.secretSourceSelector).val()))}});let form=a(questionForm.formSelector);if(form.length){form.on("submit",questionForm.send)}},send:function(){if(questionForm.validate()){let data=a(questionForm.formSelector).serialize();data+="&action="+question_params.send_action;questionForm.setSendingState();a.ajax({url:question_params.url,type:"POST",data:data,success:questionForm.showResult})}return false},showResult:function(){a.ajax({url:question_params.url,type:"POST",data:{action:question_params.success_action},success:function(b){popup.close();popup.open(b)}})},validate:function(){let fields=a(questionForm.formSelector).find('input[type="text"], textarea');let error=false;fields.each(function(){if(a(this).val().length<2){a(this).addClass("error");error=true}else{a(this).removeClass("error")}});return !error},setSendingState:function(){a(questionForm.formSelector).addClass("sending");a(questionForm.allFormElementsSelector).prop("disabled",true)},unsetSendingState:function(){a(questionForm.formSelector).removeClass("sending");a(questionForm.allFormElementsSelector).prop("disabled",false)}};questionForm.init()});